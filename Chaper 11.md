 11장 성능 향상을 위한 알고리즘 기법
 ===

## 표찾기

### 변환
- 변환 테이블을 이용해 값을 변환 시킬 수 있다.

---

### 텍스처 매핑
- 3차원 물체의 표면을 표현하기 위해 이미지를 물체의 표면에 그리는 방법
- 거리에 따라 텍스처를 조정하는 일은 복잡하다.
- 뷰포인트가 텍스처에서 멀어지면 인접한 픽셀을 서로 합쳐서 평균을 내야하는데 이 계산은 아주 빠르게 수행되어야한다.
MIP 매핑
- 픽셀은 세 가지 8비트 값으로 이루어져있는데 32 비트 시스템에서는 4분의 1을 낭비한다.
- MIP매핑은 이 공간을 이미지의 1/4 크기 복사본을 계속 넣는다.
- MIP 맵 피라미드로 표현하면 바닥으로 내려갈수록 더 자세한 이미지를 볼 수 있다.

---

### 문자 종류 판별
- 어떤 글자가 숫자, 문자 등 어떤 분류에 속하는지 판별
- if문 대신 표를 써서 문자 종류 판별 코드를 구현했다.
- 표는 문잣값을 인덱스로 사용했고, 표의 각 원소의 비트는 대문자,소문자,숫자 등 문자의 여러 가지 특성을 표현했다.

---

### 정수를 이용한 계산 방법
- 여러 연산 가운데서도 특정 연산이 시간적, 전력 소모 등의 비용 소비에서 더 적게 든다.
    ex) 정수 덧셈이나 뺄셈이 곱셈, 나눗셈 혹은 브동소수점 연산 등보다 비용 소비가 적다.

- 따라서 같은 연산을 하더라도 조금 더 적은 비용이 드는 연산을 하는 방법을 고안해야한다.

- 컴퓨터 내에서 그래픽 시스템들은 거의 대부분 좌표 시스템을 지원한다.

- 좌표계에 변환을 하여 위치 이동을 나타낸다.
    - 연산식 (캔버스 좌표계)
        x' = Ax + By + C;
        y' = Dx + Ey + F;

       - C와 F를 더하여 x',y' 를 이동시키면 평행으로 이동하게 된다.

       - A와 E를 이용하여 어떠한 물체의 크기를 변환 시킨다.

       - B와 D를 이용하여 물체를 회전 시킨다.

---

### 직선
- 한 픽셀안에서 수평선보다 대각선의 길이가 더 멀다 => 같은 픽셀에서 더 넓은 범위로 같은 양의 빛을 내므로 더 어둡다.

- 때문에, 디스플레이 설계과정에서는 이런 차이를 최소화 하기 위하여 픽셀의 모양을 조절한다.

- 시스템 내부에서는 부동 소수점 연산으로 점의 위치를 조정하여 직선을 그림.

- 60년대에는 부동 소수점 연산이 비용이 많이 든다는 이유로 사용하지 못했다. => 때문에 직선을 그리기 위한 알고리즘이 발명되었다.

- x가 변할 때마다 y를 계산하므로, 기울기를 매번 더해주면 부동 소수점 연산을 사용하지 않고도 직선을 그릴 수 있음.
    - 기울기 Dy / Dx 가 분수이므로  나눗셈이 필요한데, 이것을 덧셈과 뺄셈으로 치환. 
       1) 결정변수 d, Dy를 매 반복마다 더함.
       2) d가 Dx보다 크거나 같을 때 y++;
       3) d - Dx;
       4) 마지막으로 d의 초기 값을 0이 아닌 1/2m으로 잡으면 문제해결.
       5) But, 분수를 사용하면 비용이 커지므로, 위 연산 모두에 2를 곱하면 문제가 해결된다.

    - 이 알고리즘으로 색 그레이디언트(그라데이션)을 그릴 수 있다.

---

### 곡선 다루기
- 중심이 원점인 경우
    - 타원의 너비의 절반 a, 높이의 절반 b.
        x^2 / a^2 + y^2 / b^2 = 1;
        => A = b^2, B = a^2 일 때, Ax^2 + By^2 - AB = 0으로 치환 가능.

    - 가장 이상적인 타원에 가까운 지 결정하려면, 원점 x,y에 대하여 식의 값(0)에 가장 가까운 것이 다음 점이어야 한다.

    - 또한 사분면 내에서 찾은 수가 음수일수도 있으므로, 절댓값을 취해야한다.

    - 하지만 위의 알고리즘은 높이와 너비가 홀수 픽셀인 타원밖에 그릴 수 없다는 단점이 있다.

- 사분면을 이용한다면, x,y에 대하여 -x,y - x,-y - -x,-y 와 같이 각 사분면에서의 대칭한 점을 찍는 방법 또한 존재한다.

---

### 다항식
- 위에서 사용한 알고리즘은 원추 곡선을 그리기에는 어려움이 있다.

- 때문에 위의 계산법을 차례로 더하면서 변화를 누적시킬 수 있다면 가능하다.

- y = Ax^0 + Bx^1 + Cx^2 + Dx^n...의 형태는 상수에 점진적인 차이를 계산하여 누적시키고, 이로써, n가지 차이의 집합으로 만들어낸다.

- 위의 알고리즘과 달리 독립 변수가 하나이기 때문에 작동이 가능하다.

---

## 재귀적 분할

---

### 나선
- 라디안(radian) : 각도를 잴 때, 일반적으로 사용한다.
- 극좌표(polar coordinate) : x와 y 대신에 반지름 r과 각도 θ를 사용하는 좌표계
### 구성적인 기하
- 노드를 병합하면...
    1. 트리가 메모리를 더 적게 사용할 수 있다.
    2. 트리 깊이가 낮아지면서 트리에 대해 수행하는 여러 연산도 빨라진다.
- 쿼드트리에 불리언 함수를 적용하면? : 간단한 기하학적 요소로부터 복잡한 모양을 만들 수 있음을 알 수 있다.
- 구조적 입체 기하(constructive solid geometry) : 복잡한 3차원 물체를 만드는 기법
- 복셀(voxel) : 2차원 픽셀에 대응하는 3차원 요소 
    - 부피가 있는 픽셀 이라는 뜻이다.

---

### 시프트와 마스크
- 스캔라인 : 래스터의 한 줄
- 프레임 버퍼 : 스캔 라인을 모아둔 데이터
- 대부분의 텍스트 문자는 2차원 비트 배열인 비트맵으로 저장한다.

---

## 계산을 회피하는 그 밖의 수학적 기법들

---

### 멱급수 근삿값 계산
- 사인 함수를 계산하는 방법으로 테일러 급수가 있다.
- 사인 함수의 근삿값을 테일러 급수로 계산한 결과가 항의 개수가 늘어나면 이상적인 사인 함수에 더 가까워진다.

---

### CORDIC 알고리즘
- 정수 산술 연산을 사용해 삼각함수와 로그함수를 계산할 수 있다.
- 단위 원의 화살표 머리가 가리키는 지점의 x와 y좌표는 해당 각의 사인값과 코사인값이다. 우리가 원하는 좌표는 x축을 기준으로 화살표를 조금씩 회전시켜 구한다.
- 더 많은 항을 사용할수록 더 가까운 값을 얻을 수 있다.
- CORDIC 구현은 재귀적 분할, 미리 계산하기, 표 검색, 2의 거듭제곡 나눗셈을 시프트로 하기, 정수 고정소수점 연산, 대칭성 등 여러 가지 트릭을 활용한다.

---

## 무작위성과 관련 있는 예제들

---

### 공간을 채우는 곡선
- 자가유사성 : 멀리서 보나 가까이서 보나 곡선이 비슷해 보인다는 뜻
- 프렉탈(Fractals) : 분수라는 뜻의 프렉션(Fraction)이라는 말에서 나온 용어로 일부 작은 조각이 전체와 비슷한 기하학적 형태를 말한다. 특징으로 자기 유사성가진다. 

---

### 시스템
- L 시스템 : 재귀성으로, 자기상사도형, 프렉탈도형과 같은 형태를 단순히 기술하는 것

---

### 스토캐스틱 기법
- 스토캐스틱이란 말은 랜덤이라는 뜻으로 앞전에 L 시스템에 적용하면 비슷해보이지만 다른 형태의 도형이 나올것이다.

---

### 양자화
- 양자화 : 원래 이미지에 있는 색에 대해 변활될 이미지에서 쓸 수 있는 색을 할당해야 한다는 뜻
    - 임계화 : 어떠 한곗값을 정하고 그보다 더 밝은 값을 흰색으로, 그보다 더 어두운 색은 검은색으로 지정하는 방식
    - 디더링 : 해상도를 희생해 색이나 명암을 인식할 수 있게 하는 트레이드 오프 
        - 배열 디더링 : 각기 다른 임계치 패턴을 적용한 배열을 이미지 위에 타일링하는 방법으로 배열이 클수록 좋은 결과를 얻을 수 있다.
        - 난수를 사용한 디더링 : 각 픽셀을 난수와 비교하여 결과를 얻어낸다.
        - 플로이드-스타인버그 오류전파 : 어떤 픽셀의 오류를 가중치를 사용해 주변에 나눠주는 것
        - 리머스마 알고리즘 : 바로 옆에 있는 픽셀 중 단 하나에만 영향을 끼치는 방법
